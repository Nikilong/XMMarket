'use strict';

let mysql = require('mysql'); //引入mysql模块
// var databaseConfig = require('./mysql.config');  //引入数据库配置模块中的数据

var databaseConfig = {
    host: 'localhost',
    user: 'root',
    password: '123456',
    port: '3306',
    database: 'xmon_shop'
};

//向外暴露方法
let query = function(sql, params, callback) {
    //每次使用的时候需要创建链接，数据操作完成之后要关闭连接
    var connection = mysql.createConnection(databaseConfig);
    connection.connect(function(err) {
        if (err) {
            console.log('数据库链接失败');
            throw err;
        }
        //开始数据操作
        //传入三个参数，第一个参数sql语句，第二个参数sql语句中需要的数据，第三个参数回调函数
        connection.query(sql, params, function(err, results, fields) {
            if (err) {
                console.log('数据操作失败');
                throw err;
            }
            //将查询出来的数据返回给回调函数
            callback && callback(results, fields);
            //results作为数据操作后的结果，fields作为数据库连接的一些字段
            //停止链接数据库，必须再查询语句后，要不然一调用这个方法，就直接停止链接，数据操作就会失败
            connection.end(function(err) {
                if (err) {
                    console.log('关闭数据库连接失败！');
                    throw err;
                }
            });
        });
    });
}

var originJson = ({ "api": "mtop.alimama.union.xt.en.api.entry", "data": { "kvpairs": null, "lunaKvpairs": null, "combinePairs": {}, "kvpairsString": {}, "qtype": {}, "recommend": { "resultList": [{ "floorId": 4246, "itemId": "587715812030", "itemName": "6期免息送无线充等/保修2年 Apple/苹果 iPhone XS 深空灰色 64GB 全网通4G手机 苹果10 S 苹果XS iphonexs", "subTitle": "送无线充 店铺延保等", "userType": 1, "isTmall": true, "sellerId": 263726286, "reservePrice": "7699", "price": "7699", "promotionPrice": "7699", "priceAfterCoupon": "7699.00", "originalTkSpRates": "60 60 60", "zkSalesPrice": "7699.00", "pic": "//img.alicdn.com/bao/uploaded/i2/263726286/O1CN01yniYPI1wJ2B2uRzaq_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i3/263726286/O1CN01BAe9731wJ2B2WaTzc_!!263726286.jpg", "//img.alicdn.com/i2/263726286/O1CN01pJTkbo1wJ2947g1sx_!!0-item_pic.jpg", "//img.alicdn.com/i1/263726286/O1CN011wJ28GKioQ7xwkx_!!263726286.jpg", "//img.alicdn.com/i4/263726286/O1CN011wJ28GKjHWwBafU_!!263726286.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "0", "provcity": "上海", "nick": "能良数码官方旗舰店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DUUrqdZDTTuNw4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQOsgkIkAzYH%2BAeA7Chtxy%2Bq6mL5wK7rP3W8wV3GTBzQ5YhhQs2DjqgEA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726a", "lensId": "0bba8329_0e27_16b02ae8e8a_726a" }, { "floorId": 4246, "itemId": "580745531004", "itemName": "广州实体Apple/苹果 iPhone XR 苹果Xr 双卡手机 6.1寸、XS max", "subTitle": "", "userType": 0, "isTmall": false, "sellerId": 274432595, "reservePrice": "4888", "price": "4888", "promotionPrice": "4888", "priceAfterCoupon": "4883.00", "originalTkSpRates": "", "zkSalesPrice": "4888.00", "pic": "//img.alicdn.com/bao/uploaded/i2/274432595/O1CN011V2YGDhYnvYdL8N_!!274432595.jpg", "smallImage": ["//img.alicdn.com/i4/274432595/O1CN01NyeJsc1V2YIr3CEZE_!!274432595.jpg", "//img.alicdn.com/i4/274432595/O1CN011V2YG1LhCX4LDYK_!!274432595.jpg", "//img.alicdn.com/i2/274432595/O1CN011V2YGET0ZHYfndH_!!274432595.png", "//img.alicdn.com/i1/274432595/O1CN011V2YGDdW7KZx5m3_!!274432595.jpg"], "couponAmount": "5", "couponSendCount": 150, "couponTotalCount": 1000, "couponTag": "0", "couponEffectiveStartTime": "1558195200000", "couponEffectiveEndTime": "1561910399000", "couponStartFee": "2000", "monthSellCount": "2", "provcity": "广东 广州", "nick": "专卖港机", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": "//uland.taobao.com/coupon/edetail?e=8fTY6JmIt1ENfLV8niU3R%2Fwigsj8ztFlQS0Flu%2FfbSpbR%2B1Iwg1rhlrisGmre1IdiEFCeQ6EVaQYuF2VwEsTOGBwrqJgfTTnqXUkrbJ4NCw0njeTw8isBDN9pCXEIlWwGLhdlcBLEzhxa9Zn3ilD%2FDyJKdUTPfdeGjRY2lt7WwE%2BInh8FV60jeIg09jheaZgonv6QcvcARY%3D&&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;app_pvid:59590_11.186.131.41_2425_1559118122584;tpp_pvid:100_11.14.199.146_8605_5551559118122591843&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726b", "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DLtbkPc7lh6Zw4vFB6t2Z2ueEDrYVVa64Vb0yt%2F5tJWX%2BmkB8Ys0cBfSnYglPVAVySFiaw%2Fig9fn5r45Wg077gW1aRFN3r8%2FXfzQFu4uwqsbZn9O%2FofawqJGy92dtdXUpMDmZ2pIK9adxKmPmpIKZsA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726b", "lensId": "0bba8329_0e27_16b02ae8e8a_726b" }, { "floorId": 4246, "itemId": "594674100688", "itemName": "【618预售】 苹果XR/12期分期 Apple/苹果 iPhone XR 4G全网通手机 苹果XSMAX6Puls 8 xs iPhonexr", "subTitle": "", "userType": 1, "isTmall": true, "sellerId": 761647182, "reservePrice": "5078.01", "price": "5078.01", "promotionPrice": "5068", "priceAfterCoupon": "5058.00", "originalTkSpRates": "73 73 75 73", "zkSalesPrice": "5078.01", "pic": "//img.alicdn.com/bao/uploaded/i2/761647182/O1CN01V4NQfo22vP4ke1sMz_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i3/761647182/O1CN01At0bRY22vP4kLeP1Z_!!761647182.jpg", "//img.alicdn.com/i2/761647182/O1CN01x4GLM622vP4feXWAb_!!761647182.png", "//img.alicdn.com/i3/761647182/O1CN0189NlUg22vP4f200ct_!!761647182.jpg", "//img.alicdn.com/i3/761647182/O1CN01gkQESA22vP4fNl4xj_!!761647182.jpg"], "couponAmount": "10", "couponSendCount": 2500, "couponTotalCount": 10000, "couponTag": "0", "couponEffectiveStartTime": "1558368000000", "couponEffectiveEndTime": "1559318399000", "couponStartFee": "3000", "monthSellCount": "0", "provcity": "山东 济南", "nick": "玩风数码专营店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": "//uland.taobao.com/coupon/edetail?e=Xc%2FHoODgeeQNfLV8niU3R%2Fwigsj8ztFlQS0Flu%2FfbSpinP2GYChM67sPlpg2KVNfy5FOJP2gSFVKtlcJRLR%2FXkbg4zJ2zWtaAM%2BMit6QzPUdi6sOPVZWQuCNyioADqIaBkAErbRyEalG4OMyds1rWp360w9Kh8AHSoSv1zJtRvGDC0%2Fd%2F%2B1ZyEgfTscre%2FnAzWuH7hCAmylMDQVG07AK7A%3D%3D&&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;app_pvid:59590_11.186.131.41_2425_1559118122584;tpp_pvid:100_11.14.199.146_8605_5551559118122591843&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726c", "url": "//s.click.taobao.com/t?e=m%3D2%26s%3D6UcjUoOAzFtw4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQOrQky3qXsKhG3GIh%2FPCJQ%2FUMIkx2UChA6fIkKCNR1dEohhQs2DjqgEA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726c", "lensId": "0bba8329_0e27_16b02ae8e8a_726c" }, { "floorId": 4246, "itemId": "538199675058", "itemName": "【送延保/送壳膜/12期分期】 苹果7plus Apple/苹果 iPhone 7 Plus 全网通4G手机苹果6s 8 plus xs x", "subTitle": "12期分期 现货发 送壳膜 送1年店铺延保", "userType": 1, "isTmall": true, "sellerId": 268451883, "reservePrice": "3558", "price": "3558", "promotionPrice": "3558", "priceAfterCoupon": "3558.00", "originalTkSpRates": "60 60 60 60 60 60 60 60 60", "zkSalesPrice": "3498.00", "pic": "//img.alicdn.com/bao/uploaded/i3/268451883/O1CN01awl8rz1PmSK1UZoyE_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i1/268451883/O1CN01AYhBY31PmSK3CiDXL_!!268451883.jpg", "//img.alicdn.com/i3/268451883/TB1e9z1bDZRMeJjSspoXXcCOFXa_!!0-item_pic.jpg", "//img.alicdn.com/i3/268451883/TB2y0m6Xezz11Bjy1XdXXbfqVXa_!!268451883.jpg", "//img.alicdn.com/i1/268451883/TB2_k14XgfC11BjSszcXXc44pXa_!!268451883.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "143", "provcity": "山东 济南", "nick": "三际数码官方旗舰店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3D4TJ29EybnRBw4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQOeM3g4Fpbtigm9hQVBpCwYcXprEX00vexVbXf3zeOwfkhhQs2DjqgEA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726d", "lensId": "0bba8329_0e27_16b02ae8e8a_726d" }, { "floorId": 4246, "itemId": "590498017056", "itemName": "天语老人机超长待机大屏直板按键移动备用老年手机正品功能机小学生男女款三星华为苹果诺基亚手机官方旗舰店", "subTitle": "", "userType": 1, "isTmall": true, "sellerId": 547686779, "reservePrice": "299", "price": "299", "promotionPrice": "109", "priceAfterCoupon": "106.00", "originalTkSpRates": "", "zkSalesPrice": "299.00", "pic": "//img.alicdn.com/bao/uploaded/i3/547686779/O1CN01E0pENN1zwpRRYUzb0_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i2/547686779/O1CN016vLqRN1zwpRO2itC2_!!547686779.jpg", "//img.alicdn.com/i1/547686779/O1CN010C8BrQ1zwpRPaV0aV_!!547686779.jpg", "//img.alicdn.com/i4/547686779/O1CN015bs6Vc1zwpRPr19G4_!!547686779.png", "//img.alicdn.com/i2/547686779/O1CN01lCqHH11zwpRPaWt0v_!!547686779.jpg"], "couponAmount": "3", "couponSendCount": 2588, "couponTotalCount": 10000, "couponTag": "0", "couponEffectiveStartTime": "1556726400000", "couponEffectiveEndTime": "1561910399000", "couponStartFee": "105", "monthSellCount": "4", "provcity": "广东 深圳", "nick": "鑫睿诚数码专营店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": "//uland.taobao.com/coupon/edetail?e=mHfHe1I9FcwNfLV8niU3R%2Fwigsj8ztFlQS0Flu%2FfbSpinP2GYChM67sPlpg2KVNfy5FOJP2gSFVKtlcJRLR%2FXlQ1myjPnrnESZXbpn871CYdi6sOPVZWQuCNyioADqIaBkAErbRyEalUNZsoz565xOVAlgbnNub%2BtKJUSBgmGayDC0%2Fd%2F%2B1ZyEgfTscre%2FnAzWuH7hCAmylMDQVG07AK7A%3D%3D&&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;app_pvid:59590_11.186.131.41_2425_1559118122584;tpp_pvid:100_11.14.199.146_8605_5551559118122591843&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726e", "url": "//s.click.taobao.com/t?e=m%3D2%26s%3Dt4AmEm3n4j5w4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQO4DAQA0zApWLsqB07OLzYXd46x7bl8hZgPNbySrb1JUwhhQs2DjqgEA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726e", "lensId": "0bba8329_0e27_16b02ae8e8a_726e" }, { "floorId": 4246, "itemId": "588211090826", "itemName": "回收二手手机苹果id锁iPhoneXsMax惠普华硕戴尔外星人笔记本电脑", "subTitle": "", "userType": 1, "isTmall": true, "sellerId": 3000087387, "reservePrice": "20", "price": "20", "promotionPrice": "20", "priceAfterCoupon": "20.00", "originalTkSpRates": "", "zkSalesPrice": "20.00", "pic": "//img.alicdn.com/bao/uploaded/i3/3000087387/O1CN01mhiiSb24RIEthrOIE_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i1/3000087387/O1CN01XNCDuF24RIErIZU2S_!!3000087387.jpg", "//img.alicdn.com/i2/3000087387/O1CN01xcLVJO24RIEoxcI3p_!!3000087387.jpg", "//img.alicdn.com/i2/3000087387/O1CN01hJVcFI24RIEoxPkmW_!!3000087387.jpg", "//img.alicdn.com/i3/3000087387/O1CN01SXpD0R24RIEoYQ59G_!!3000087387.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "3", "provcity": "广东 广州", "nick": "麦芮蜜旗舰店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DTy9wURi84BZw4vFB6t2Z2ueEDrYVVa64szgHCoaJEBX%2BmkB8Ys0cBfSnYglPVAVySFiaw%2Fig9fn5r45Wg077gW1aRFN3r8%2FXf8DD9IhzeLJgzS8oEZQTH%2BN4aNiDRX7u9k4y6qMAAIbGDF1NzTQoPw%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_726f", "lensId": "0bba8329_0e27_16b02ae8e8a_726f" }, { "floorId": 4246, "itemId": "558962496147", "itemName": "Apple/苹果 iPhone 8 i8港版 港行澳门版 全新原装 正品国行手机", "subTitle": "", "userType": 0, "isTmall": false, "sellerId": 22456878, "reservePrice": "3750", "price": "3750", "promotionPrice": "3750", "priceAfterCoupon": "3750.00", "originalTkSpRates": "", "zkSalesPrice": "3750.00", "pic": "//img.alicdn.com/bao/uploaded/i2/22456878/TB2LoFnnOCYBuNkSnaVXXcMsVXa_!!22456878.jpg", "smallImage": ["//img.alicdn.com/i3/22456878/TB2r9mii.l7MKJjSZFDXXaOEpXa_!!22456878.jpg", "//img.alicdn.com/i2/22456878/TB2nltdeWmWQ1JjSZPhXXXCJFXa_!!22456878.jpg", "//img.alicdn.com/i4/22456878/TB2RboQXLNZWeJjSZFpXXXjBFXa_!!22456878.jpg", "//img.alicdn.com/i1/22456878/TB2PymLi.F7MKJjSZFLXXcMBVXa_!!22456878.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "2", "provcity": "广东 珠海", "nick": "lannl", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DoRBlVne%2BSi5w4vFB6t2Z2ueEDrYVVa64qYbrUZilZ4UKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQObbA1DzFv0xzsHHI932WXgpXCByReWxzyrPnb9xnV4fMThoRFBh1mfA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_7270", "lensId": "0bba8329_0e27_16b02ae8e8a_7270" }, { "floorId": 4246, "itemId": "543628924234", "itemName": "正品纽曼 V18军工三防老人机路虎全网通4G超长待机电信版大字大声大屏按键诺基亚老人手机华为三星苹果备用机", "subTitle": "三防手机 全网通 大字大声大屏 可当充电宝", "userType": 1, "isTmall": true, "sellerId": 547686779, "reservePrice": "399", "price": "399", "promotionPrice": "168", "priceAfterCoupon": "163.00", "originalTkSpRates": "", "zkSalesPrice": "399.00", "pic": "//img.alicdn.com/bao/uploaded/i4/547686779/O1CN01Llu5Bg1zwpQYpeuq4_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i3/547686779/TB28ipVlJRopuFjSZFtXXcanpXa_!!547686779.jpg", "//img.alicdn.com/i2/TB1_DM8LXXXXXc3XXXXXXXXXXXX_!!0-item_pic.jpg", "//img.alicdn.com/i3/1688913659/TB2qqEGawxlpuFjy0FoXXa.lXXa_!!1688913659.jpg", "//img.alicdn.com/i3/547686779/TB24ZY_iY0kpuFjy0FjXXcBbVXa_!!547686779.jpg"], "couponAmount": "5", "couponSendCount": 4258, "couponTotalCount": 10000, "couponTag": "0", "couponEffectiveStartTime": "1556726400000", "couponEffectiveEndTime": "1561910399000", "couponStartFee": "138", "monthSellCount": "24", "provcity": "广东 深圳", "nick": "鑫睿诚数码专营店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": "//uland.taobao.com/coupon/edetail?e=agH6KsXyS8gNfLV8niU3R%2Fwigsj8ztFlQS0Flu%2FfbSp4QsdWMikAalrisGmre1Id0BFAqRODu13ZNYPD3XU3Yg0v1o2wOQEgQBDOcCOBLyxzsUZcuGfM8iKipqvWaPpkqdG3DhI3Cc89RJXDpekj6qVMKAv50nWNt3fEZUDJ5EpmGGEh63vKnE04mW%2BqsTaHonv6QcvcARY%3D&&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;app_pvid:59590_11.186.131.41_2425_1559118122584;tpp_pvid:100_11.14.199.146_8605_5551559118122591843&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_7271", "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DTrTFRRNLluVw4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQO4DAQA0zApWLsqB07OLzYXbj8Cm8j3o1mj%2BCF67RTfabpVHfApBtvIqJn5AyUbPoV&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_7271", "lensId": "0bba8329_0e27_16b02ae8e8a_7271" }, { "floorId": 4246, "itemId": "581356913989", "itemName": "Apple/苹果 iPhone XR 全网通手机 苹果xr 正品手机【商场同款 同城闪送】", "subTitle": "无线充电 双卡双待 A12仿生芯片", "userType": 1, "isTmall": true, "sellerId": 4104684984, "reservePrice": "5699", "price": "5699", "promotionPrice": "5699", "priceAfterCoupon": "5699.00", "originalTkSpRates": "", "zkSalesPrice": "5699.00", "pic": "//img.alicdn.com/bao/uploaded/i1/4104684984/O1CN01q7U8dt1mgiWGC21YA_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i2/4104684984/O1CN01iIOIJT1mgiWGrFy4Y_!!4104684984.jpg", "//img.alicdn.com/i2/4104684984/O1CN0158RDvL1mgiSuyXytR_!!4104684984.jpg", "//img.alicdn.com/i1/4104684984/O1CN011mgiSuoBV7gDGDS_!!4104684984.jpg", "//img.alicdn.com/i1/4104684984/O1CN01p5FlMW1mgiStYwrRb_!!4104684984.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "0", "provcity": "福建 厦门", "nick": "正飞中博数码旗舰店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DUNAuLQLuURxw4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQONge5w4QWBO1Xp1XgwQHYEvESCVKcXAZRstiRNz%2B9j05xKmPmpIKZsA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_7272", "lensId": "0bba8329_0e27_16b02ae8e8a_7272" }, { "floorId": 4246, "itemId": "587715128938", "itemName": "6期免息送无线充等/保修2年 Apple/苹果 iPhone XS 银色 64GB 全网通4G手机 苹果10 S 苹果XS iphonexs", "subTitle": "送无线充 店铺延保等", "userType": 1, "isTmall": true, "sellerId": 263726286, "reservePrice": "7799", "price": "7799", "promotionPrice": "7799", "priceAfterCoupon": "7799.00", "originalTkSpRates": "60 60 60", "zkSalesPrice": "7799.00", "pic": "//img.alicdn.com/bao/uploaded/i3/263726286/O1CN019wgzcx1wJ2B3wNU3X_!!0-item_pic.jpg", "smallImage": ["//img.alicdn.com/i2/263726286/O1CN01OLYfeo1wJ2B55j7IV_!!263726286.jpg", "//img.alicdn.com/i2/263726286/O1CN01pJTkbo1wJ2947g1sx_!!0-item_pic.jpg", "//img.alicdn.com/i1/263726286/O1CN011wJ28GKioQ7xwkx_!!263726286.jpg", "//img.alicdn.com/i4/263726286/O1CN011wJ28GKjHWwBafU_!!263726286.jpg"], "couponAmount": null, "couponSendCount": 0, "couponTotalCount": 0, "couponTag": "", "couponEffectiveStartTime": "", "couponEffectiveEndTime": "", "couponStartFee": null, "monthSellCount": "1", "provcity": "上海", "nick": "能良数码官方旗舰店", "realPostFee": "0.00", "ostime": null, "oetime": null, "jddPrice": null, "jddNum": null, "uvSumPreSale": "", "couponShareUrl": null, "url": "//s.click.taobao.com/t?e=m%3D2%26s%3DrDPYWc71hh9w4vFB6t2Z2ueEDrYVVa64RZKDdhY4Y8EKwPl3T8wu7OFfEkbWjUOGGbNHkReO7fc1sZpe12KEHNdlXPHrc%2BQOsgkIkAzYH%2BAeA7Chtxy%2Bq6mL5wK7rP3WI%2BLS5FBlvuUhhQs2DjqgEA%3D%3D&scm=null&pvid=100_11.14.199.146_8605_5551559118122591843&app_pvid=59590_11.186.131.41_2425_1559118122584&ptl=floorId:4246;pvid:100_11.14.199.146_8605_5551559118122591843;app_pvid:59590_11.186.131.41_2425_1559118122584&union_lens=lensId:0bba8329_0e27_16b02ae8e8a_7273", "lensId": "0bba8329_0e27_16b02ae8e8a_7273" }], "pvid": "100_11.14.199.146_8605_5551559118122591843", "navigator": null, "totalCount": 4306953, "lunaHead": { "docsfound": "4306953", "status": "OK" } }, "meta": { "reserveRoot": "recommend", "reserveAttrs": "navigator" } }, "ret": ["SUCCESS::调用成功"], "v": "2.0" })
var json = originJson.data.recommend.resultList;

// 淘宝json存入数据库
for (let i = 0; i < json.length; i++) {
    break;
    // for (let i = 0; i < 1; i++) {
    let ele = json[i];
    // console.log(Object.keys(ele));
    let keysL = Object.keys(ele);
    // console.log(keysL.length)
    let sqlValues = [];
    for (let j = 0; j < keysL.length; j++) {
        // console.log(keysL[j] + "----" + ele[keysL[j]])
        if (ele[keysL[j]] === null || ele[keysL[j]] === "null" || ele[keysL[j]] === true) {
            ele[keysL[j]] = ""
        }
        if (typeof(ele[keysL[j]]) === 'object') {
            ele[keysL[j]] = ele[keysL[j]].join("|&&|")
        }
        sqlValues.push(ele[keysL[j]])
    }

    let valuesIcon = Array.from(Object.keys(ele).map(() => "?"))
    let createSql = `insert into tb(${Object.keys(ele).join(",")}) values(${valuesIcon.join(",")});`;

    // console.log(sqlValues.length)
    // console.log(sqlValues)
    // console.log(createSql)
    // continue;
    query(createSql, sqlValues, function(result, fields) {
        console.log('创建结果：');
        console.log(result);
    });

}

/**
 * 
//img.alicdn.com/i1/268451883/O1CN01b3Tp4w1PmSJzxkVo4_!!268451883.jpg|&&|//img.alicdn.com/i2/268451883/TB2Tw55XcrC11Bjy1zjXXcduVXa_!!268451883.jpg|&&|//img.alicdn.com/i4/268451883/TB2PUoVaNvzQeBjSZFEXXbYEpXa_!!268451883.jpg|&&|//img.alicdn.com/i4/268451883/TB2pm8ahbXlpuFjSszfXXcSGXXa_!!268451883.jpg

 */

// 淘宝商品详情图片加入数据库
let photOURL = `select itemId,smallImage from shop;`
let count = 0;
query(photOURL, [], function(result, fields) {
    // console.log(result);

    for (let i = 0; i < result.length; i++) {
        break;
        // console.log(result[i])
        // console.log(result[i].itemId + "---" + result[i].smallImage)
        if (result[i].smallImage.indexOf("|&&|") > -1) {
            let imgArr = result[i].smallImage.split("|&&|");
            for (let j = 0; j < imgArr.length; j++) {
                console.log(count + "        " + result[i].itemId + "        http:" + imgArr[j])
                count++;
                // let creatPhotos = `insert into production_photo(itemId,img_url) values(${result[i].itemId},"${'http:' + imgArr[j]}");`;
                // query(creatPhotos, [], function(result, fields) {
                //     console.log(result);

                // });
            }
        } else {
            count++;
        }
    }
});
